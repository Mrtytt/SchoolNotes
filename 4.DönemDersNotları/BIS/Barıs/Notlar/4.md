### System Utilities 'Sistem programları'

hardware - os - system utilities - application programs
                sistem programları uygulama programları

kernelın dışında olan ama sistemin çalışması için gereken programlar

#### File management
- dosyalar, **dizinler işlemleri**

#### Status information
- tarih, saat, hafıza, disk, boş alan, kullanıcı sayısı bilgileri istenebilir
- log, debug, performans bilgileri istenebilir
- bazı sistemler registry yapısına sahiptir

#### File modification
- **dosya içeriği** görüntüleme değiştirme

#### programming-language support
- genelde c, cpp desteklerler

#### program loading / execution
- bir programı derledikten sonra hafızaa yüklenip çalıştırılmak için kullanılır

#### Communications
- processler, sistem progamları , kullanıcılar , bilgisayarlar , kernel içinde bağlantı kurulmasını sağlar

#### Background services
- **service, subsytem veya daemon** olarak adlandırılır
- bazıları çalışır bazıları **tetikleme** bekler
- bazıları sistem boot edildikten sonra sonlandırılır bazıları çalışmaya devam eder
- ex: görev yöneticisi


### İşletim sistemi tasarımı ve gerçekleştirilmesi

#### Tasarım hedefleri
    kullanıcı dostu, kolay, hızlı
    gereksinim belirlenmesi

%%SORU%% 
#### Mekanizmalar ve Kurallar 
* **Kurallar** 'policy'           ne yapacağını belirler
* **Mekanizmalar** 'mechanisms'   nasıl yapılacağını belirler
* ikiside güncellenebilir, kurallar resource allocation için önemlidir

- ex: CPU’nun korunması için timer kullanımı mekanizmadır, bir kullanıcı için timer süresinin ne kadar olacağına karar vermek kuraldır.

#### Implementation
* ilk işletim sistemi assembly
* günümüz işletim sistemleri c ile
* kernel kısmı assembly ile daha yüskek işlemler c/cpp ile yazılır

- bir işletim sisteminin **yüksek seviyeli** dillerle yazılması **farklı mikro işlemcilerde** çalışabilmesini kolaylaştırır

* ms-dos 8088 assembly ile yazılmış intelde çalışır
* **yüksek seviyeli** dillerde yazılan işletim sistemleri **daha yavaştır**, daha fala depolama ister
* linux c ile yazılmıştır ve intel x86, oracle, ibm powerpc de çalışabilir

## Kernel 'Çekirdek'
işletim sistemninin donanıma en yakın kısmıdır

### İşletim sistemi yapısı, mimarileri
    # Monolitik 'basit' yapı
        elinde bir kernel var ne var ne yoksa içinde
        tüm programlar kernela gömülmüş
        sistemde oluşabilecek herhangi bir hata sistemin çökmesine sebep olabilir

        MS-DOS ve ilk UNIX örnek verilebilir

        MS-DOS process önceliklendirme yoktur
        MS-DOS un bu özelliği kötücül uygulamaların sistemi kolayca çökertebilmesini sağlar

        UNIX ilk geliştirildiğinde sistem ve kullanıcı programı olarak ayırmış

        yüksek memory kullanımı
        kernel karmaşıklaşır
        %%SORU:rutinler%%

    # Katmanlı 'Shell' yapı
        işletim sistemlerin gelişmesiyle ihtiyaç duyulan servislerin kernela dahil edilmek yerine katman katman dahil edilmesi
        en alt katman hw en üst katman gui
        katman sayısı sınırlı değildir fakat katman eklendikçe karmaşıklık artar
        katmanlarda yapılan bir güncelleme hepsinin tekrar compillanmasını gerektirir
        her katman ayrı ayrı debug edilebilir
        her katman altındaki katmanın özelliklerini kullanabilir ama bu sistemi yavaşlatır
        katman sayısını az şekilde olması gerektirir

    # Mikro kernel
        sistemin açılıp çalıştırılması için gereken sistemleri içeriyor
        bu yaklaşımda diğer acil olmayan kernaldaki sistemler sistem programı haline geliştirilmiş

        unix geliştikçe kernel büyümüş ve yönetimi zor hale gelmiş
        '80 carnegie mellon üni **Mach** adında mikro kernel yapısı kullanan bir işletim sistemi geliştirilmiştir

        interprocess communication , memory management , cpu scheduling
        processler arası iletişim  mesaj gönderimi ile yapılmıştır
        çoğu servis kullanıcı olarak çalıştığından daha güvenlidir

        Mac OS X kernelı kısmen mikro kernela sahiptir
        Microsoft Net 4.0 ?

        bellek yönetimi, register yönetimi birbirleriyle iletişim kurarak çalışır
        bu sayede biri çökerse diğeri çalışmaya devam edebilir
        **yoğun mesaj trafiği** vardır monolitiğe göre yavaş kalır

    # Modüler
        kernel boot sırasında veya sistemin çalışması devam derken yüklenen bileşenlere modüllere sahiptir
        Modern işletim sistemlerinde popülerdir
        cpu ve hafıza yönetimi kerneldadır diğerleri modül olarak yüklenebilir
        bir modül kendisini yükledikten sonra başka modüller çağırabilir veya iletişime geçebilir
        linux cihaz sürücüleri ve dosya sistemleri için kernel modüllerini kulanır

    # Hibrit
        günümüz işletim sistemleri tek bir yapıda değildir
        farklı yapıların + yönlerini alırlar

        Linux ve Solaris monolitik yapıdadır ama kernel kısmına yeni fonksiyonlar dinamik olarak eklenebilir

        Windows monolitik yapıdadır ama bazı temel işlevleri mikro kernelda yapar

        bu tip yapılarda çekirdek zayıflatılır ve gelişmiş görevler için dinamik modüllerin eklenmesine izin verilir

        Yeniden derleme gerektirmez
        
        Mac OS X hibrit yapıya sahip
            GUI - Aqua
            kernel - Mach, BSD
            I/O kit - Kernel Extensions

            Cocoa objective C diline api sağlar

            Mach: Hafıza yönetimi, thread yönetimi, çağrı başlatma, processler arası iletişim sağlar
            BSD: command-line, ağ ve dosya sistemleri

        IOS
            Mac OS X üzerine yapılandırılmıştır
            Cocoa Touch: objective c için api sağlar
            Media services: grafik ve video
            Core services: cloud computing, db computing
            Core OS en alt katmandır

        Android
            Hibrid yapı
            açık kaynak kodludur
            zengin framework
            
            ...
            Libraries - Android Runtime
            Linux Kernel

            kernel power management , cihaz sürücüleri , process yönetimi , hafıza yönetimi
            Android runtime - java için kütüphaneleri sağlar
            dalvek virtual machine - java uygulamalarını çalıştırır
            küthüphaneler ...
    
    # Exokernel 'dış çekirdek' 
        işletim sistemlerinin temel fonksiyonlarından biri olan donanıma erişim yordamını diğer uygulamalarında erişimine açar

        bellek ve process yönetimi dışında tek yaptığı şey donanım arayüzlerini çoklayarak uygulamalara aktarırı 'multiplexing'

        **donanım bazlı** bir işlem yapıyorsak exokernel kullanılabilir
        programlanması zordur bu yüzden gerçek hayatta tercih edilmez

### İşletim sisteminde debugging
    # Hata analizi
        bir process hata verdiğindde os bunu **log** dosyasına yazar
        aynı zamanda memorynin anlık durumunu da **memory dump** kaydeder
        kernelde oluşan hata **crash** olarak adlandırılır

    # Performance tuning
        sistemin performansını arttırmak için yapılan işlemlerdir
        sistemin tıkanıklıklarının anlaşılması için kullanılır

        task manager örnek verilebilir

### işletim sistemlerinin kurulması

### system boot
    kernelin yüklenerek başlatılmasına **booting** denir
    **bootstrap** rom üzerindedir ve kerneli yükler
    boot kısmına sahip olan disk, boot disk veya system disk olarak adlandırılır
    mobil cihazlarda eprom yaygındır

## Process Kavramı
    %%süreç, işlem , process anlamında kullanılmıştır%%

    **modern işltemin sistemlerinde process işin bir parçasıdır**
    **CPU aralarında geçiş yaparak tüm processlerin eş zamanlı çalıştırabilir**

    bir sistem tek kullanıcılı bile olsa birden fazla uygulamayı birlikte çalıştırabilir

    işletim sistemi multitasking desteklmesede eğer context switch yapılabiliyorsa os kendi fonksiyonlarını çağırarak bunun benzerini yapabilir

    bir programın os kontrolü altında çalıştırılan canlı-aktif halidir
    **bir programın çalıştırılması için os tarafından bir process oluşturulmalı ve process ile ilgili program ilişkilendirmelidir**
    programın çalışması için gereken kod parçacıkları processe aktarılır

    processler programlardan bağımsız varlıklardır bir x procesi bir gün chrome yarın excell çalıştırabilir

    daha hızlı çalışabilmek adına işletim sistemleri boşta iken hazırda processler bekletir 'yedekli çalışıyor'

    bir process ancak 1 program ile ilişkilendirebilir ama bu ilişki çalışma sırasında değiştirilebilir
    process ile program arasında 1:1 ; program ile process arasında 1:N ilişki vardır

### process oluşturma adımları
    ..
    üretilen bir process tamamen durdurulanakadar bekletilerek yeniden kullanılabilir    

### 
    bir process yürütmekte olduğu işi, program counter değerini, cpu registerlerinin değerlerini içermektedir

    stack - ... - heap - data - text
                         ^ global değişkenler

    her processin process kontrol bloğu vardır 'processin kimlik kartı'

%%TODO: Resim%%
### process state
    new         process oluşturulmaktadır
    running     komutlar çalıştırılmaktadır
    waiting     process bir olayın gerçekleşmesini beklemektedir 'I/O bekliyor olabilir'
    ready       cpu ya geçmek için bekliyor
    terminated  process çalışması sonlandırılır

    bunların bir çoğunda queue veri yapısı kullanılır
    waiting de queueden bahsetmek doğru değildir

### process control block
    her process os de bir pcb tarafından temsil edilir

    process state       
    process number 'pid'    unique dir
    program counter         birsonraki çalışacak kodun yeri
    ---
    registers
    ---
    memory limits           base adrresin neresi limitin neresi olduğu yazar
    list of open files
    ---
    ...
    ---
    cpu scheduling information      önceliğini içerir
    accounting information          
    i/o status                      

    bir process çalışmaya başlamadan önce ilk yüklenene process kontrol bloğu bilgileri yüklenir

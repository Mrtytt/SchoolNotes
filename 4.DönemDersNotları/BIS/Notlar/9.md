###

// deadlock, starvation, race sistemin performansını etkiler kurtulunmalıdır.

### Processlerin Etkileşimi
	(R) Rekabet
		- Processlerin birbirinden habersiz olduğu durum.
	(R) Paylaşım Yoluyla İşbirliği
		- Processlerin dolaylı olarak birbirinden haberleri vardır.
		- Dosya ortak, iş ortak olabilir.
	(R) Haberleşme yoluyla işbirliği
		- Processlerin doğrudan birbirlerinden haberleri vardır.

#### Rekabet
	- Birbirinden habersiz processslerin aynı kaynağı (ram,cpu time) kullanım istekleri
	- Bir processin sonuçları diğerinden bağımsız ise
	- Her ne kadar bağımsız processler olsa da kaynaklar ortak olduğu için **processin çalışma süresini etkiler**.

	(R) Karşılıklı dışlama 'mutual exclusion'
		- Bir processin kritik sectionu çalışıyorken başka bir processin kritik section çalışmaz, 
		collision oluşabilir.
	(R) Ölümcül kilitleme 'deadlock'
		- Satrançtaki açmaz gibi iki taraf da hamle yapamaz.
	(R) Yarış 'race'
		- Kaynağı ilk gelen ilk alır.
		- Senkronizasyon yoksa yarış durumu oluşur.
	(R) Açlık 'starvation'
		- Çok uzun bir süre başka bir processin ihtiyacı olan kaynağı bırakmaksak ona ihtiyacı olan
		- process açlık durumunu yaşar.

#### Paylaşım Yoluyla İşbirliği
	- Paylaşım 			-> Dosya, veri tabanı
	- Üretilen çıktı 	-> Girdi, çıktı

	- Karşılıklı Dışlama 'mutual exclusion' gereklidir.
		**Okuma işlemi yapılırken buna gerek yoktur.**
		**Yazma işleminde gereklidir.**
	- Senkronizasyon gereklidir.

	(R) Sorunlar
		- Deadlock, Race, Starvation

#### Haberleşme Yoluyla İşbirliği
	- Mesaj aktarımı yoluyla haberleşme
	- Karşılıklı Dışlama gerekli değil
	(R) Sorunlar
		- Deadlock
			- Birbirinden mesaj bekleyen 2 process
		- Starvation
			- 2 process msajlaşabilir, 3. Process ikisinden birinden mesaj bekler.

	// Critical Section
		- Program kodunun main methodu, paylaşılan kaynaklar üzerinden işlem yapan kısmı 
	// Mutual Exclusion
		- Belirli bir andan sadece 1 processin critical section'nun çalışması.
	// Deadlock
		- Birinin istediği kaynağı bir diğeri tutup bırakmaz ise, processler ilerleme kaydedemez.
		- Yeniden başlatmak, tüm processlerin kaynaklarını almak.
		- Task Manager, bir processin kaynalarını elinden almak.
	// Race
		- Sonuç processlerin çalışma hızına ve sıralarına bağlıdır.
		- Aynı ortak verilere erişen processler.
		- Farklı çalışmalarda farklı sonuçlar üretilebilir.
	// Starvation
		- Aynı kaynakları kullanan processler.
		- Processlerin kaynaklarına hiç erişmeme durumu.
		- Sonsuz beklemeye girebilirler.

### Processlerin Senkronizasyonu
	- Paylaşılan bir değişkene aynı anda sadece bir processin erişimini sağlamak zorundadır.
	buna 'process syncronization' denir.
	- Aynı veriye erişim, multi-core işlemcilerde zorunludur.
	- Entry sectionu 	->	critical section'a giriş izni ister.
	- Critical section 	-> 	ortak kısımlar üzerinde işlem yapan kod bloğu. 
							Global değişkenler yer alabilir.
	- Exit section 		->	bulunabilir.

#### Kritik Bölüm Problemi
	%%BANKO SORU%%
		1 - **Mutual Exclusion** Birinin kritik bölümü çalışıyorsa diğerlerine izin verilmemeli.
		2 - **Progress** Hiç birinin kritik bölümü çalıştırmıyorsa herhangi birine izin verilir.
		3 - **Bounded Waiting 'Sınırlı Bekleme'** Bir process izin istemesinden ve izin alınana 
		kadar istenilen süre kısıtlanmalıdır.

	- Hafıza tahsisi ve interrupt gibi yapılar 'race' durumuna örnektir.
	(R) Primitive Kernel
		- Bir process kernel modda çalışıyorken sonsuz öncelikte olabilir.
		- Çalışıyorsa sonsuza kadar çalışabilir.
	(R) Non-Primitive Kernel
		- Bir process kernel modda çalışıyorken sonsuz öncelikte olamaz.
		- Onun yerine başka daha önemli bir process çalıştırılabilir.
		%%SORU%%
			**Race Condition Oluşmaz**

	- SMP 'Symetric Multiprocessing' de primitive sistemler kurgulanması daha zordur.
	- **Primitive Sistemler** daha hızlı cevap verir bu nedenle **gerçek zamanlı sistemlerde**
	kullanılır.

	(R) **Peterson Çözümü**
		- Yazılım bazlı kritik bölüm problemi çözümüdür.
		- 2 değişken eklenir. Flag ve Turn.
		
		- **boolen flag[ ] 'Bayrak'** 	-> 	True ise kritik sectiona girme isteğidir.
		- **int turn 'Sıra'**			->  Sıralamasını belirliyor.

		- Flag true ve turn geldiyse processin kritik sectionu çalışır ve flag false olur.

	(R) **Senkronizasyon Donanımı**
		- Donanım tabanlı çözümler maliyetlidir.
		- Kilitlenme 'locking' yapısıyla çözüm arar. Peterson yöntemini donanımsal yaklaşımıdır.
		- Tek işlemcili sistemlerde interruptların paylaşılmış veriye erişimi engellenirse
		sorun basitçe çözülmüş olur.
		- Komut sırası ya da önceliklendirme olmazsa sorun çözülmüş olur.
		- Non-primitive kernel'ların sıklıkla kullandığı yaklaşımdır.
		- Çok işlemcili sistemlere uygun değildir. Interruptların açılıp kapanması için
		mesaj göndermek zaman alır, performans düşer.

		// Atomik -> Peşi sıra çalışması gereken 2 metod, sırası değiştirilemez.
		// Context Switch işlemin de atomik olarak çalışır.

		- Bounded Waiting sağlanmaz, yazılımla bu eklenebilir.

#### Mutex Kilitlenmeleri
	- Yazılım Tabanlı

	- Kritik bölüme girecekse acquire() function çalıştırır.
		available = false
	- Kritik bölüme çıkacaksa release() function çalıştırır.
		available = true

	- Boolen available değeri vardır. Erişilebilirliği değiştirir.

#### Semaforlar
	- Bir int değeri üzerinden ilerlenir.
	- Çalışacaksa semafor değeri azaltılır.
	- Geri verilince de semafor değeri arttırılır.
	(R) **Sayma Semaforları**
		- Sistemde ne kadar kaynak varsa onun sayısına eşittir.
		- 10 yazıcı varsa int 10 dan başlar.
		- Haynağı kullanmak isteyen process semafor üzerinde wait işlemi gerçekleştirilir.
		Bırakıldığında signal çalışır değeri 1 artar.
	(R) **Binary Semafor**
		- 0 kullanılıyor.
		- 1 kullanılmıyor.
		- Mutex lock gibi davranır.

	- Her semafor PCV pointer'ına sahiptir.

	```c
		wait(S){
			while(S >= 0) // busy
			S--;
		}
		signal(){S++;}
	```

	(R) Deadlock
		- P0 -> wait(S) wait(Q) signal(S) signal(Q)
		- P1 -> wait(Q) wait(S) signal(Q) signal(S)
						^ kilitlenme
						
#### İzleyiciler 'Monitors'
	- Semaforlar kullanıldığında hatalar oluşabilir.
	- Programcudan kaynaklı sorunları engeller.
	- Bir struct class oluşturularak mutex ve semafor gibi işlemler fonksiyon olarak gerçekleştirir.
	- Monitor kendi verilerine erişebilir, fonksiyonlar kendi içinde sıralıdır.

	```cs
		condition x,y; 	// bunlar cooperating processler koşul olduğu için.
		y.signal()
		x.wait()
	```
	

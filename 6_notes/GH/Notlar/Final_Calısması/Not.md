## Genomiğe Giriş
- İnsan genomundaki nükleotidler: ~ 3 milyar
- İnsan genomundaki genler: ~ 20.000 – 25.000

- 10**14 insanda hücre sayı
- 10**15 bakteri hücresi

- Double-stranded DNA **transcription** işlemi sonrasında Single-stranded RNA oluyor. 
- **Translation** işleminden sonra ise protein oluyor.
- **Ribozom**, mRNA'yı üçlüler (kodonlar) halinde okuyarak bir protein sentezler. Her kodon bir aminoasite çevrilir .

## Transcription / Translation machinery hataları
- **Synonymous(eşanlamlı) Mutation** - 1 nükleotid değişti, kodladığı amino asit aynı
- **Missense(yanlışlık) Mutation** - 1 nükleotid değişti, kodladığı amino asit değişti
- **Nonsense Mutation(anlamsız)** - 1 nükleotid değişti, amino asit belirlenen yerde stop oluşması
- **Frameshift(çerçeve değiştirme)** - Kayma

- RNA --- reverse transcription işlemi --- DNA

- Farklı hücre türlerinin tümü tek hücreli bir embriyodan gelir. Bu tek hücrenin bölünmesiyle diğer hücrelere talimatlar dizi halinde kodlanarak gidiyor. 
DNA moleküllerindeki dört nükleotid, Adenin, Guanin, Sitozin ve Timin (dört harfle kodlanmıştır: A, C, G ve T) belirli bir sırayla, bilgiyi yaşam boyu saklar.
RNA da Timin yerine Urasil

----------------------------------------------------------------------------------------

## GENOME NEDİR
- Bir organizmanın tüm kalıtsal bilgileri içeren DNA dizisinin tamamına genom denir. Genom, bir organizmayı inşa etmek ve sürdürmek için gereken tüm bilgileri içerir.
- Kalıtım bilgisi sabit uzunlukta değildir.
- İnsan genomunda 46 kromozom ve 3 milyarın üzerinde baz çifti bulunurken, buğday genomunda 42 kromozom ve 17 milyar baz çifti bulunur;
Organizmaların genom dizileri, dizileme teknolojisi kullanılarak elde edilir.

- İlk insan genomunun tahmini maliyeti 1999-2000'de 300 milyon dolardı; Bugün yüksek kaliteli bir insan genomu 1500 dolara elde edilebiliyor. 

## GEN NEDİR
Genomda yer alan spesifik bölgeler fiziksel yapıyı etkileyecek bilgiler içermektedir. Bu tür bilgileri içeren bölgelere gen denir.

Bilginin yeni hücrelere aktarılması için DNA kopyalanır. Etkinleştirilirse, genler çekirdekte (ökaryotlarda) haberci RNA'lara (mRNA'lar) kopyalanır, ardından mRNA'lar (eğer gen protein kodluyorsa) sitoplazmada proteinlere dönüştürülür.

### Genetik bilgiden protein üretme süreci:
- Ribozom instruction'lar gelmesi durumunda ilgili proteini üretebilir.
**Instruction: DNA'da saklı(gen bilgisi)**
**DNA'dan ribozoma bilgi nasıl aktarılacak?**
CEVAP
DNA'dan ribozoma bilgi, DNA'daki genlerin transkripsiyon adı verilen bir süreçle mRNA'ya kopyalanmasıyla gerçekleşir. mRNA daha sonra hücre çekirdeğinden ribozomlara taşınarak protein sentezinin başlamasını sağlar.

- Moleküler biyolojinin “merkezi dogması” olarak bilinen DNA, RNA ve proteinler

- Proteinler yaşam için gerekli elementlerdir. Tüm canlı hücrelerin büyümesi, onarımı, işleyişi ve yapısı bunlara bağlıdır.

- Bilgi aktarımı sürecinin ilk adımına (DNA dizisinin bir kısmının RNA kopyasının üretilmesi) transkripsiyon adı verilir. Bu görev RNA polimeraz enzimi tarafından gerçekleştirilir. 

- Çekirdek promotörler, transkripsiyonu destekleyen ve transkripsiyonun başlangıç ​​bölgesinin yukarısında bulunan DNA bölgeleridir.

**Kontrol mekanizması nasıl olacak?**
**Kaynak genler. O zaman genler nasıl kontrol edilecek?**

- RNA polimerazlar bu kompleksleri tanır ve RNA sentezini başlatır, polimeraz şablon DNA boyunca hareket eder ve bir RNA kopyası oluşturur.

- Genlerin kontrol edilmesi, gen ifadesinin düzenlenmesini içeren karmaşık bir süreçtir. Gen ifadesi, bir genin DNA'dan RNA'ya (transkripsiyon) ve ardından RNA'dan protein sentezine (translasyon) kadar olan süreci içerir. Genlerin nasıl kontrol edildiği, bu süreçlerin her aşamasında düzenlenir. 

- Protein kodlayan genlerin aksine, kodlamayan RNA (ncRNA'lar) genleri işlenir ve transkripsiyondan sonra ve translasyona girmeden fonksiyonel yapılarına bürünür, dolayısıyla kodlamayan RNA'lar adı da buradan gelir. 

- Enzim ve diğer bazı proteinler ilgili genin ön kısmında konumlandıklarında DNA'nın ilgili kısmı fermuar benzeri açılır.
**Regülasyon:** mRNA üretimi için ilgili enzim ve faktörlerin çekirdeğe ulaşması lazım.
**DNA'nın %2'si gen bölgesi ise, geriye kalan %98 ne işe yarar?**

- DNA'nın %2'si gen bölgesini kodlar, geriye kalan %98 ise genler arasındaki düzenlemeler, intronlar, tekrarlı diziler ve diğer düzenleyici bölgeler gibi işlevler için kullanılır.  DNA'daki bu bölgeler, genlerin nasıl etkinleştirileceğini veya kapatılacağını belirler.

----------------------------------------------------------------------------------------

- Proteinlerin şifresi organizmaların DNA’sında yer alır. Proteinler DNA ile etkileşime girerek diğer proteinlerin ifade regülasyonunu yapar. 

- Activator’ler gen üretimini hızlandırır. Repressors gen üretimini azaltır

- E. Coli ömrü boyunca ~10 üzeri 6 protein üretir. Yaklaşık 1000 protein içeriyordu. Her protein için yaklaşık ~1000 kopya

- Protein ve DNA ile kodlanan AND kapısı

- lacZ geni 2 sensör proteini tarafından yönetilir : **lactose sensorü,glucose olmama sensorü**

- Gen regülasyon ağları tekrar eden bloklar şeklinde basitleştirilebilir. Network motifleri işleyen ağlara ait fonksiyonel bloklardır.

- Node sayısı arttıkça motif bulma konusundaki hesaplama modelleri exponansiyel biçimde karmaşıklaşmakta.

----------------------------------------------------------------------------------------

**Gen regülasyonu:** Bir organizmanın gen ifadesinin, yüksek düzeyde çevresel değişikliklere ve hücresel ihtiyaçlara uygun olarak düzenlenmesidir. Bu süreç, genlerin etkinleştirilmesi veya kapatılması yoluyla gerçekleşir ve hücrenin fonksiyonunu ve davranışını belirler.

- Gen ifadesini düzenleyen mekanizmalar, bir gen ürününün (protein veya ncRNA olabilir) nerede ve ne kadar üretilmesi gerektiğini belirliyor. 

### Gen regülasyonunda görev alan elemanlar:
- **Çekirdek promotörler**, transkripsiyonu destekleyen ve transkripsiyonun başlangıç ​​bölgesinin yukarısında bulunan DNA bölgeleridir.

- **TATA kutusu:** TF'lerin bağlandığı yer. gene 30 bp uzunluğa kadar yer alabilir.

- **Enhancer:** gen üretiminin hızlanmasını sağlayan bölge. Moleküller bağlanınca mRNA üretimi hızlanır

- **Silencer:** Üretimi durdurmaya yarar.Susturucular arttırıcılara benzer; ancak bunların etkisi, hedef genin transkripsiyonu üzerindeki arttırıcıların tersidir ve transkripsiyon seviyelerinin azalmasıyla sonuçlanır. Drosophila'da uzun menzilli ve kısa menzilli olmak üzere iki tip susturucu bulunmaktadır. Kısa menzilli susturucular destekleyicilere yakındır ve uzun menzilli susturucular birden fazla destekleyiciyi veya güçlendiriciyi kilobazlar ötesinde susturabilir.

- **Insulator:** Erişimi engelleyen bölge. Yalıtkan bölgeler, diğer düzenleyici elemanların etkisini belirli kromozomal sınırlarla sınırlar

- **LCR:** Locus bazında kontrol sağlayan bölge. Bu bölgede hem insulator ve enhanced kısımlar yer alır. Lokus kontrol bölgeleri (LCR'ler), bir lokustaki gen setinin tamamını kontrol eden farklı düzenleyici elemanların kümeleridir.

- **Vekil promoter elemanlar:** Promoter bölgesindeki mutasyon gendeki mutasyondan çok daha olumsuz etki yapabilir.

**Transkripsiyon faktörleri**, düzenleyici bir bölgeye bağlanacak spesifik bir DNA motifini tanıyan ve bu düzenleyici bölgeyle ilişkili genin transkripsiyon hızını düzenleyen proteinlerdir
- İlk olarak transkripsiyon faktörü TFIID, TATA kutusuna bağlanır. Daha sonra genel transkripsiyon faktörleri devreye alınır ve başlatıcı dizide transkripsiyon başlatılır. 

**Epigenetik düzenleme**, DNA paketlemesinin ve yapısının düzenlenmesidir ve bunun sonucu da gen ekspresyonunun düzenlenmesidir.

### Epigenetik yönetim:
- Genlerden bağımsız bir yönetim. Gen regülasyonundan bağımsız yönetim modelleri

**1.Metilasyon:** DNA zincirinde nükletotide bağlantı şansı bulunan bir kimyasal molekül vardır buna metil denir. Genin başlangıç bölgesine Metil bağlanması durumunda DNA'nın fermuarı yeterince açılamadğınından mRNA kopyası üretilemeyecek

**2. Histon modifikasyou:** DNA'nın sarılı olduğu proteinlerin yapısındaki küçük değişimler DNA'nın fermuar şeklinde açılmasına engel olabilir. Bu durumda bazı genlerden mRNA üretilemiyebilir.
- Histonlar, bir nükleozom oluşturan proteinlerdir

----------------------------------------------------------------------------------------

**DNA Splicing:** Genden protein üretme esnasında gerçekleşen bir olay. Bir gen intron ve exonlardan oluşmakta.

- mRNA oluşurken intron bölgelerinin ayıklanması gerekiyor.

**DNA mutasyonu:** Mutasyonlar fenotip farklılığının temel sebebi

- Genomdaki mutasyonlar birçok nedenden dolayı meydana gelir: 
    - Öncelikle DNA replikasyonu hatasız bir süreç değildir. 
    - Hücre bölünmesinden önce DNA, 10^8 ila 10^10 baz çifti başına 1 hatayla kopyalanır.
    - İkincisi, UV ışığı gibi mutajenler genomda mutasyonlara neden olabilir.
    - Mutasyona katkıda bulunan üçüncü faktör kusurlu DNA onarımıdır.

- Her hücre bölünmesinde 10^8 - 10^10 baz çiftte bir mutasyon kendiliğinden oluşuyor.
    - UV ışık bu oranı arttırır. 
    - DNA'nın tamir mekanizmasının da sorunu çözememesi gerekli

## Mutasyon Türleri: 
- Mutasyonlar DNA yapısına etkilerine göre sınıflandırılabilirler:
    - **Baz Yer Değiştirme:** Bir bazın başka bir bazla değiştirilmesidir.
    - **Silme:** Bir veya daha fazla baz silinir.
    - **Ekleme:** Genoma eklenen yeni baz veya bazlar.
    - **Mikrosatellit mutasyonu:** Art arda tekrarlanan küçük DNA bölümlerinin küçük eklemeleri veya silinmeleri.
    - **İnversiyon:** Bir DNA parçası yönünü 180 derece değiştirir.
    - **Translokasyon:** Bir DNA parçası genomda başka bir yere taşınır.

- Mutasyonlar büyüklüklerine göre de şu şekilde sınıflandırılabilir:
    - **Noktasal mutasyonlar:** Herhangi bir konumda tek bir karakter mutasyonu
    - **Küçük ölçekteki mutasyonlar:** Bir kaç nukelotidden oluşur. Birkaç baz içeren mutasyonlar.
    - **Büyük ölçekteki mutasyon:** Kromozom seviyesinde ortaya çıkan değişimler.
    - **Anöploidiler:** Tüm kromozomların eklenmesi veya silinmesi.
    - **Tüm genom poliploidileri:** Tüm genomu içeren kopyalar.

- Mutasyonlar gen fonksiyonu üzerindeki etkilerine göre şu şekilde sınıflandırılabilir:
    - **İşlev kazanımı mutasyonları:** Değiştirilen gen ürününün yeni bir moleküler işleve veya yeni bir gen ekspresyonu modeline sahip olduğu bir mutasyon türü.
    - **Fonksiyon kaybı mutasyonları:** Protein fonksiyonunun azalmasına veya ortadan kalkmasına neden olan bir mutasyon. Bu daha yaygın görülen mutasyon türüdür.

- Exome bölgesinde okuma başlangıcı: **ATG**, bitiş **TAG, TGA, TAA.**

**Mutasyonlar sonucunda:** Bir protein işlevini kaybeder. Daha önceden etkin olmayan bir protein oluşur.

**Sekanslama eknolojileri:**
    - Chip-SEQ
    - RNA-SEQ

**Ekstraksiyon:** Bu, ilgilenilen genetik materyali, RNA veya DNA'yı çıkardığınız adımdır.

________________________________________________________________________________________

## Genomik ve R
### Genomik veri analizinin adımları
    - Veri toplama
    - Veri kalitesi kontrolü ve temizliği
    - Veri işleme
    - Keşif amaçlı veri analizi ve modelleme
    - Görselleştirme ve raporlama

### Genomik için neden R kullanılıyor?
    - Veri temizleme ve işleme
    - Genel veri analizi ve keşfi
    - Genomik spesifik veri analizi yöntemleri
    - Görselleştirme

----------------------------------------------------------------------------------------

## R Projesi
- Bioconductor projesi ( http://bioconductor.org/ ), hesaplamalı biyoloji ile ilgili paketler için özel bir paket deposudur. Ancak R'nin CRAN adı verilen ana paket deposunda aynı zamanda hesaplamalı biyoloji ile ilgili paketler de bulunmaktadır.

- **install.packages()** CRAN paketlerini (#, R'deki yorum karakteridir) kullanarak kurabilirsiniz.

- **install_github():** Paketteki işlevi kullanarak GitHub'tan paketleri yükleyebilirsiniz devtools.

- Paketleri kurmanın başka bir yolu da kaynaktandır.

- **download.file("https://github.com/al2na/methylKit/releases/download/v0.99.2/methylKit_0.99.2.tar.gz",destfile="methylKit_0.99.2.tar.gz")**

- **update.packages()** CRAN ve Bioconductor paketlerini de güncelleyebilirsiniz. 

- **help()** fonksiyonlarını kullanarak fonksiyonlar hakkında yardım alabilirsiniz.

- **search()** fonksiyonlarını kullanarak arama yapabilirsiniz

- **ls()** fonksiyonları ile listeleme yapabilirsiniz.

----------------------------------------------------------------------------------------

## VERİ YAPILARI
- **Vektörler** 
- Temel R veri yapılarından biridir. Temel olarak aynı türdeki öğelerin (sayısal, karakter veya mantıksal) bir listesidir.

- y <- 1:5                  # 1'den 5'e kadar ardışık sayılardan oluşan vektör
- y + 2                     # Her elemana 2 ekler
- 2 * y                     # Her elemanı 2 ile çarpar
- y^2                       # Her elemanı karesini alır
- 2^y                       # 2'nin her elemana karşılık gelen kuvvetini alır

- r1 <- rep(1, 3)           # 3 tane 1'den oluşan vektör

- **Matrisler**
- m2 <- matrix(c(1, 3, 2, 5, -1, 2, 2, 3, 9), nrow = 3)

- t(m1)                     # Matrisin transpozunu al
- dim(m1)                   # Matrisin boyutlarını verir (satır x sütun)

- x <- c(1,2,3,4)
- y <- c(4,5,6,7)
- m1 <- cbind(x,y)

- **DATA FRAME** 
- Bir veri çerçevesi bir matristen daha geneldir, çünkü farklı sütunlar farklı modlara (sayısal, karakter, faktör vb.) sahip olabilir.

- chr <- c("chr1", "chr1", "chr2", "chr2")
- strand <- c("-", "-", "+", "+")
- start <- c(200, 4000, 100, 400)
- end <- c(250, 410, 200, 450)

- mydata <- data.frame(chr, start, end, strand)   # Veri çerçevesi oluşturma
- names(mydata) <- c("chr", "start", "end", "strand") # Sütun isimlerini değiştirme

### Veri çerçevesinden veri seçme (alt kümeleme)
- mydata[, 2:4]                 # 2, 3 ve 4. sütunları seç
- mydata[, c("chr", "start")]   # Belirtilen sütunları ada göre seç
- mydata$start                  # 'start' sütununu seç
- mydata[c(1, 3), ]             # 1. ve 3. satırları al
- mydata[mydata$start > 400, ]


- **LİSTELER**
- R'deki bir liste, nesnelerin (bileşenlerin) sıralı bir koleksiyonudur. Liste, çeşitli (muhtemelen ilgisiz) nesneleri tek bir ad altında toplamanıza olanak tanır. 

w <- list(
  name = "Fred",
  mynumbers = c(1, 2, 3),
  mymatrix = matrix(1:4, ncol = 2),
  age = 5.3
)
w

### Liste elemanlarına erişim
w[[3]]            # 3. eleman (mymatrix)
w[["mynumbers"]]  # İsme göre erişim
w$age             # $ işareti ile erişim (yaş bilgisi)

Faktörler kategorik verileri depolamak için kullanılır. Kategorik değişkenler istatistiksel modellerde sürekli değişkenlerden farklı şekilde ele alındığından istatistiksel modelleme için önemlidirler. Bu, kategorik verilerin istatistiksel modellerde buna göre işlenmesini sağlar.
features=c("promoter","exon","intron")
f.feat=factor(features)

----------------------------------------------------------------------------------------

- 4 veri türü vardır bunlar:
    - numeric
    - logical
    - character
    - integer. 
    Tüm bu veri türleri yerel olarak vektörler oluşturmak için kullanılabilir.

----------------------------------------------------------------------------------------

- BED formatı veri okuma için popüler

----------------------------------------------------------------------------------------

x<-rnorm(50)
hist(x)

hist(x,main="Hello histogram!!!",col="red")

x<-rnorm(50)
y<-rnorm(50)
plot(x,y,main="scatterplot of random samples",
        ylab="y values",xlab="x values")

Ayrıca x ve y vektörleri için kutu grafikleri de çizebiliriz. Kutu grafikleri, sayısal veri gruplarını çeyrekleri aracılığıyla gösterir. Kutunun kenarları 1. ve 3. çeyrekleri gösterir ve kutuyu kesen çizgi medyandır. 1. ve 3. çeyrekler arasındaki mesafeye çeyrekler arası tange denir. 

boxplot(x,y,main="boxplots of random samples")

perc=c(50,70,35,25)
barplot(height=perc,
        names.arg=c("CpGi","exon","CpGi","exon"),
        ylab="percentages",main="imagine %s",
        col=c("red","red","blue","blue"))
legend("topright",legend=c("test","control"),
       fill=c("red","blue"))

Birden fazla grafiğin birleştirilmesi

par(mfrow=c(1,2)) # 

# make the plots
hist(x,main="Hello histogram!!!",col="red")
plot(x,y,main="scatterplot",
        ylab="y values",xlab="x values")

pdf("mygraphs/myplot.pdf",width=5,height=5)
plot(x,y)
dev.off()

plot(x,y)
dev.copy(pdf,"mygraphs/myplot.pdf",width=7,height=5)
dev.off()

3. Genomik İstatistik

3.1 Veri noktalarının toplanması nasıl özetlenir: İstatistiksel dağılımların arkasındaki fikir

Deneylerin doğası ve biyolojideki doğal çeşitlilik, bir şeyi her ölçtüğünüzde aynı kesin ölçümleri almanızı imkansız hale getiriyor.

Nüfus parametrelerini örnek parametrelerden tahmin ediyoruz ve bu tahminlerle ilgili bazı belirsizlikler var.

Belirli değerler numunenin büyük bir kısmıyla karşılaştırıldığında çok yüksek veya düşükse, bu durum ortalamayı bu aykırı değerlere doğru kaydıracaktır. Ancak medyan aykırı değerlerden etkilenmez.

x=runif(10)
mean(x)   - 
median(x) - medyan

x=rnorm(20,mean=6,sd=0.7)
var(x) - varyans
sd(x)  - standart sapma

x=rnorm(20,mean=6,sd=0.7)
IQR(x)

IQR(x) fonksiyonu, bir veri kümesinin çeyrekler arası aralığını (interquartile range) hesaplar. Çeyrekler arası aralık, veri setinin üst çeyreği (75. yüzdelik) ile alt çeyreği (25. yüzdelik) arasındaki farktır. 

quantile(x)
##       0%      25%      50%      75%     100% 
## 5.437119 5.742895 5.860302 6.243991 6.558112

sıklıkla kullanılan dağılımlar - Normal d. , Gauss d.

R'de, fonksiyon ailesi *norm( rnorm, dnorm, qnorm ve pnorm), olasılıkları hesaplamak ve normal dağılımdan alınan rastgele sayılar üretmek gibi normal dağılımla çalışmak için kullanılabilir.

dnorm(-2, mean=0, sd=2) ifadesi, normal dağılımın -2 değerindeki yoğunluk fonksiyonunu hesaplar. Bu, ortalama (mean) değeri 0 ve standart sapması (standard deviation) 2 olan normal dağılımdaki -2 noktasındaki olasılığı belirtir.

# X= -2 olduğunda olasılık yoğunluk fonksiyonunun değerini al,
# mean=0 ve sd=2 olduğunda
dnorm(-2, mean=0, sd=2)

# P(X =< -2) olasılığını al, burada ortalama=0 ve sd=2
pnorm(-2, mean=0, sd=2)

# P(X > -2) olasılığını al, burada ortalama=0 ve sd=2
pnorm(-2, mean=0, sd=2,lower.tail = FALSE)

# ortalama=0 ve sd=2 olan normal dağılımdan 5 rastgele sayı al
rnorm(5, mean=0 , sd=2)

# ortalama=0 ve sd=2 olan P(X > y) = 0,15'e karşılık gelen y değerini al
qnorm( 0.15, mean=0 , sd=2)

dbinom - binom dağılımı içindir.
dpois - Poisson dağılımı için kullanılır
dnbinom - negatif binom dağılımı için kullanılır
dfdchisq- Varyasyonun dağılımı ile ilgili olarak (F dağılımı) ve (Ki-Kare dağılımı) kullanılır.

İki örnek küme arasında fark - hipotez

Ortalamalar arasındaki farkı da t-testi kullanarak hesaplayabiliriz. 

# plot the data points
plot(x,y,pch=20,
     ylab="Gene Expression",xlab="Histone modification score")
# plot the linear fit
abline(mod1,col="blue")


set.seed(100)
gene1=rnorm(30,mean=4,sd=2)
gene2=rnorm(30,mean=2,sd=2)
gene.df=data.frame(exp=c(gene1,gene2),
                  group=c( rep(1,30),rep(0,30) ) )

mod2=lm(exp~group,data=gene.df)
summary(mod2)

Bu kod, iki farklı genin ifade düzeylerini (gene1 ve gene2) grup değişkenine göre incelemek için bir doğrusal regresyon modeli oluşturur. Sonuçlar, bu modelin özet istatistiklerini (summary) sağlar.

lm - lineer regresyon sağlar

Regresyon, istatistiksel bir analiz yöntemidir ve bir değişkenin başka bir veya birden fazla değişkenle ilişkisini modellemek için kullanılır. 
Korelasyon, istatistikte iki değişken arasındaki ilişkinin gücünü ve yönünü ölçen bir terimdir.


Sınıflandırma, denetimli(supervised); kümeleme denetimsiz(unsupervised) öğrenme metodudur.

Sınıflandırmada
-Verilerin etiketi vardır.
-Verileri bir gruba dahil etmek için bir kural oluşturulmasını bekler.
-Veri setini eğitim ve test olarak ayırmak gereklidir.

Kümelemede,
-Verilerin etiketi yoktur.
-Verileri bir gruba yakınlığa/benzerliğe/alakaya/hiyerarşiye göre dahil eder.
-Verideki örüntülerini ve yapıları tespit eder.

4. Denetimsiz Makine Öğrenimi 

Kümeleme (clustering), veri kümesinde benzer özelliklere sahip olan veri noktalarını gruplamak için kullanılan bir veri analizi yöntemidir. 
Kümeleme için gerekli ilk adım mesafe ölçüsüdür.

“Manhattan mesafesi” veya “L1 normu”  -- gen ekspresyon vektörleri arasındaki mesafeye ilişkin basit bir ölçüm, gen ekspresyon değerleri arasındaki mutlak farkın toplamıdır.
“Öklid Mesafesi” veya “L2 normu” --- mesafelerin karelerinin toplamını kullanır ve elde edilen değerin karekökünü alır;
Tanıtacağımız son ölçüm “korelasyon mesafesi” dir . Bu basitçe  DAB=1−ρ , ρ iki vektör arasındaki Pearson korelasyon katsayısıdır; 

dist(df,method="manhattan")
##          patient1 patient2 patient3
## patient2        7                  
## patient3       24       27         
## patient4       25       28        3

dist(df,method="euclidean")
##           patient1  patient2  patient3
## patient2  4.123106                    
## patient3 14.071247 15.842980          
## patient4 14.594520 16.733201  1.732051

as.dist(1-cor(t(df))) # correlation distance
##             patient1    patient2    patient3
## patient2 0.004129405                        
## patient3 1.988522468 1.970725343            
## patient4 1.988522468 1.970725343 0.000000000

scale(df)

Hiyerarşik kümeleme

d=dist(df)
hc=hclust(d,method="complete")
plot(hc)

Bu, en yaygın kümeleme algoritmalarından biridir. Bu algoritmayı kullanarak bireysel veri noktalarının ilişkisini ve kümelerin ilişkilerini görebilirsiniz. 
Sonuçta ağaç yapısı veya dendogram elde ederiz.

Argüman method, alt kümelerin nasıl birleştirileceğini yönlendiren kriterleri tanımlar. 
“complete”
“single”
“average”
“ward.D2” ve “ward.D” 

K-means clustering - “k” sayıda kümeye böler veya bölümlere ayırır (Hartigan ve Wong 1979 ) . Bu nedenle bu tür yöntemlere genel olarak “bölümleme” yöntemleri adı verilmektedir. 

set.seed()Tekrarlanabilirlik için kullanacağız. 

kclu=kmeans(t(mat),centers=5)  

Bir başka ilgili ve belki de daha sağlam algoritmaya "k-medoids" kümeleme adı verilir (Reynolds, Richards, Iglesia, ve diğerleri 2006 ) . Prosedür, birkaç fark dışında k-ortalama kümelemeyle neredeyse aynıdır.

Küme sayısı olan “k” nasıl seçilir
-Siluet
-Boşluk istatistiği (Gap statistic)
-Diğer yöntemler

Aslında paket, NbClustoptimal küme sayısını belirlemek için 30 farklı yol sağlar ve en iyi sayıyı seçmek için bir oylama mekanizması sunabilir.

Boyut Azaltma Teknikleri
Temel bileşen analizi (PCA), yüksek boyutlu verileri incelemek için belki de en popüler tekniktir.

PCA'yı hesaplamanın daha yaygın bir yolu, tekil değer ayrışımı (SVD) adı verilen bir yöntemdir. Bu, PCA'nın "gizli faktör" veya "gizli bileşen" yorumu olarak adlandırılan başka bir yorumuyla sonuçlanır.
Son olarak PCA'nın gizli faktör yorumunu SVD aracılığıyla sunabiliriz. 

Boyutsallığın azaltılması için diğer matris çarpanlara ayırma yöntemleri

Bağımsız bileşen analizi (ICA) - İlk olarak PCA'nın bir uzantısı olan bağımsız bileşen analizi (ICA) ile başlayacağız. ICA algoritması belirli bir matrisi ayrıştırır 

Negatif olmayan matris çarpanlarına ayırma (NMF)
Negatif olmayan matris çarpanlara ayırma algoritmaları, matrisi ayrıştırmayı amaçlayan bir dizi algoritmadır. X matrislerin çarpımına K Ve H,X = KH

t-Dağıtılmış Stokastik Komşu Yerleştirme (t-SNE) -- t-SNE, yüksek boyutlu uzaydaki mesafeleri daha düşük boyutlara haritalar ve bu açıdan MDS yöntemine benzer.

Denetimli Makine Öğrenimi (Supervised Learning)
Etiketli Veri Kullanımı:

Denetimli öğrenmede, modelin eğitimi için giriş verileri (input) ve bu girişlere karşılık gelen doğru çıkışlar (output) yani etiketler (labels) gereklidir.
Model, giriş-çıkış çiftleri üzerinden eğitilerek, yeni veri noktaları için doğru çıkışları tahmin etmeyi öğrenir.

Denetimsiz Makine Öğrenimi (Unsupervised Learning)
Etiketsiz Veri Kullanımı:

Denetimsiz öğrenmede, model yalnızca giriş verileri ile eğitilir; çıkış veya etiketler verilmez.
Model, verideki gizli desenleri veya yapıları keşfetmeye çalışır.


5.2 Denetimli makine öğrenimindeki adımlar
Verilerin ön işlenmesi
Eğitim ve test verilerinin bölünmesi
Modelin eğitimi
Modelin performansının tahmin edilmesi
Model ayarlama ve seçimi

Eğitime başlamadan önce verileri ön işlememiz gerekecek. Bu, değişkenlerin ve örneklerin birbirleriyle nasıl ilişkili olduğunu görmek için keşfedici veri analizini içerebilir
İlk yapacağımız şey veri normalizasyonu ve dönüşümü olacak. 

VERİ ÖN İŞLEME
1. Veri dönüşümü
2. Verileri filtreleme ve ölçeklendirme
3. Eksik değerlerle uğraşmak

VERİLERİ BÖLME
Dayanma testi veri seti
Çapraz doğrulama
Önyükleme yeniden örneklemesi

tgexp=merge(patient,tgexp,by="row.names")
rownames(tgexp)=tgexp[,1]
tgexp=tgexp[,-1]

set.seed(3031)
# get indices for 70% of the data set
intrain <- createDataPartition(y = tgexp[,1], p= 0.7)[[1]]
training <- tgexp[intrain,]
testing <- tgexp[-intrain,]	

Alt türü k-en yakın komşularla tahmin etmek

Kavramsal olarak k-en yakın komşular (k-NN), daha önce gördüğümüz kümeleme algoritmalarına çok benzer. Örnekler arasındaki mesafeyi ölçebilirsek en yakın olanı bulabiliriz. 

library(caret)
knnFit=knn3(x=training[,-1], # training set
            y=training[,1], # training set class labels
            k=5)
# predictions on the test set
trainPred=predict(knnFit,training[,-1])

k dikkate alınacak en yakın komşuların sayısıdır.

MODELİMİZİN PERFORMANSINI DEĞERLENDİRME
Alıcı Çalışma Karakteristiği (ROC) eğrileri
Performansı değerlendirirken önemli ve popüler bir ölçüm, alıcı işletim karakteristiği (ROC) eğrilerine bakmaktır. ROC eğrisi, modelin sınıf olasılıklarının bir eşik sürekliliği boyunca değerlendirilmesiyle oluşturulur. 

MODEL AYARLAMA VE FAZLA UYUMDAN KAÇINMA

Model ayarı ve testi için veri bölme stratejileri
Veri bölme stratejisi, test hatasının doğru tahmini için gereklidir. 
-Eğitim-doğrulama-testi
-Çapraz doğrulama


Ağaçlar ve ormanlar: Rastgele ormanlar iş başında

Decision trees (Karar ağaçları)
Karar ağaçları, çoğunlukla yorumlanabilirliklerinin çok yüksek olması nedeniyle çeşitli makine öğrenimi görevleri için popüler bir yöntemdir. Karar ağacı, tahmin değişkenleri üzerindeki bir dizi filtreden oluşur. Filtre dizisi bir sınıf tahmininde son bulur. Her filtre ikili bir evet/hayır sorusudur ve bu, filtre dizisinde çatallanmalar yaratarak ağaç benzeri bir yapıya yol açar. 

Rastgele Ormanlar:
Tanım: Birden fazla karar ağacının birleşimidir.
Rastgelelik: Her ağaç, rastgele seçilen veri ve tahmin değişkenleri ile eğitilir.
Amacı: Aşırı uyumu azaltarak modelin genel performansını artırmak.
Önyükleme Yeniden Örneklemesi: Eğitim verilerinden yeniden örnekleme yapılarak ağaçlar oluşturulur.
OOB Hata Tahmini: Önyükleme yeniden örneklemesi kullanılmayan verilerle (out-of-bag) hata tahmini yapılır.


mtry: Her bölünmede örneklenecek tahmin değişkenlerinin sayısı.
min.node.size: Terminal düğümlerinin minimum düğüm boyutu, ağaçların derinliğini kontrol eder.

LOJİSTİK REGRESYON
Lojistik regresyon, öngörücü değişkenlere dayalı bir ikili yanıt değişkenini modellemek için kullanılan istatistiksel bir yöntemdir. Başlangıçta iki sınıflı veya ikili yanıt problemleri için tasarlanmış olmasına rağmen, bu yöntem çok sınıflı problemlere genelleştirilebilir.

Lojistik regresyon, bir bağımlı değişkenin (genellikle ikili bir sonuç olan 0 veya 1) belirli bir bağımsız değişkenler kümesine dayanarak tahmin edilmesini sağlayan istatistiksel bir modeldir. Özellikle sınıflandırma problemlerinde kullanılır ve bağımlı değişkenin kategorik olduğu durumlarda etkilidir.

Gradient boosting (Gradyan Artırma)
Gradyan artırma, rastgele ormana benzer bir karar ağaçları topluluğu kullanan bir tahmin modelidir. Ancak karar ağaçları sırayla eklendiğinden bu modellere “Çoklu Toplamsal Regresyon Ağaçları (MART)” adı da verilmektedir 

Destek Vektör Makineleri (SVM)
Destek vektör makineleri (SVM), algoritmanın verimliliği ve performansı nedeniyle 90'lı yıllarda popüler hale geldi (Buser, Guyon ve Vapnik 1992 ) . Algoritma, veri noktalarını farklı gruplara (veya sınıflara) ayıran en uygun karar sınırını belirleyerek çalışır ve ardından bu ayırma sınırına dayalı olarak yeni gözlemlerin sınıfını tahmin eder. Duruma bağlı olarak farklı gruplar doğrusal düz bir çizgiyle veya doğrusal olmayan bir sınır çizgisi veya düzlemle ayrılabilir.

Sinir ağları ve derin versiyonları
Sinir ağları, son zamanlarda yeniden popülerlik kazanmaya başlayan bir başka popüler makine öğrenme yöntemidir.Sinir ağlarının avantajı SVM'ye benzer, doğrusal olmayan karar sınırlarını modelleyebilirler. Sinir ağlarının temel fikri, yanıt değişkenini doğrusal olmayan bir fonksiyon olarak modellemek için öngörücü değişkenleri birleştirmektir.

6 GenomicRanges Paket ile genomik aralıklarla işlemler

GRanges( GenomicRangespaketten) genomik aralıkları ve bu aralıklar hakkında ek bilgileri tutan ana nesnedir. 

gr=GRanges(seqnames=c("chr1","chr2","chr2"),
           ranges=IRanges(start=c(50,150,200),
                          end=c(100,200,300)),
           strand=c("+","-","-")
)
gr

Sık kullanılan dosya formatları
BED
GFF
BAM/SAM
BigWig
Generic Text files
Tabix/Bcf

SummarizedExperimentsınıf idealdir. Her genomik aralıkla ilişkili çok katmanlı tablo verilerini ve satırlar ve sütunlarla ilişkili veya her tabloyla ilişkili meta verileri tutabilir. 

colData()ve rowData()sütunla ilişkili ve satırla ilişkili tabloları çıkarın. metaData()İlişkili herhangi bir tablo varsa meta veri tablosunu çıkarır.

alt kümeleme
se[1:5, 1:3]

Yüksek verimli sıralama okumaları genellikle sıralama tesislerinden "FASTQ" veya "fastq" adı verilen formatta metin dosyaları olarak çıkarılır. Bu format, FASTA adı verilen daha önceki bir formata bağlıdır. FASTA formatı, nükleotid veya protein dizilerini temsil etmek için metin bazlı bir format olarak geliştirildi

FASTA dosyasının ilk satırı genellikle “>” (büyüktür) sembolüyle başlar. Bu ilk satıra “açıklama satırı” adı verilir ve sonraki satırlarda sıra ile ilgili açıklayıcı bilgiler bulunabilir. 

FASTA formatının bir uzantısı FASTQ formatıdır. Bu format, sıralama makinelerinden temel kalite ölçüm çıktılarını işlemek için tasarlanmıştır.


RNA-seq (RNA dizileme), yüksek verimlilikte gen ifadesinin belirlenmesi için kullanılan bir moleküler biyoloji teknolojisidir. Bu teknoloji, hücrelerdeki gen ifadesini belirlemek için kullanılan RNA moleküllerinin dizilmesine dayanır. RNA dizileme, genomik dizileme teknolojilerinin gelişimiyle mümkün olmuştur ve gen ifadesinin anlaşılmasına, mRNA varyantlarının tespitine ve transkripsiyonal regülasyonun araştırılmasına olanak tanır.

Gen ekspresyonu, genin spesifik nükleotid sekansında kodlanan moleküler ürünlerin aktivitesi yoluyla bir genin, bir hücrenin genel fonksiyonlarına ve fenotipine katkısını tanımlamak için kullanılan bir terimdir. RNA, bir hücrenin çekirdeğinde kopyalanan, bir gende kodlanan birincil üründür. Bir RNA molekülü sınıfı olan haberci RNA'lar, çekirdekten sitoplazmaya taşınır; burada hücrenin çeviri mekanizması, mRNA'nın nükleotid dizisini proteinlere çevirir.

ChIP-seq (Chromatin Immunoprecipitation Sequencing), genomdaki belirli DNA-protein etkileşimlerini belirlemek için kullanılan bir moleküler biyoloji teknolojisidir. Özellikle, belirli bir proteinin DNA'ya bağlanma yerlerini (bağlanma bölgeleri veya hedefler) belirlemek için kullanılır. ChIP-seq, epigenetik araştırmalarda ve transkripsiyonel düzenleme mekanizmalarının anlaşılmasında önemli bir rol oynar.

Farklar:
Amaç: RNA-seq, gen ifadesini belirlemek için kullanılırken, ChIP-seq, belirli protein-DNA etkileşimlerini belirlemek için kullanılır.

Çalışma Prensibi: RNA-seq, RNA moleküllerinin dizilenmesine dayanırken, ChIP-seq, DNA-protein etkileşimlerinin belirlenmesine dayanır.

Kullanım Alanları: RNA-seq, gen ifadesi analizi ve RNA varyant analizi gibi alanlarda kullanılırken, ChIP-seq, transkripsiyonel düzenleme çalışmaları ve epigenetik araştırmalar gibi alanlarda kullanılır.,:İ